<!-- 🎶 ARKA PLAN MÜZİĞİ -->
<audio id="bg-music" autoplay loop preload="auto" playsinline>
  <source src="muzik.mp3" type="audio/mpeg">
  Tarayıcınız bu ses formatını desteklemiyor.
</audio>

<!-- Ses butonu -->
<button id="music-toggle"
  style="position:fixed;right:12px;bottom:12px;z-index:50;
         border:none;border-radius:999px;padding:10px 12px;
         background:#4f46e5;color:#fff;font-size:16px;cursor:pointer;">
  🔊
</button>

<script>
(function(){
  const audio = document.getElementById('bg-music');
  const btn = document.getElementById('music-toggle');

  // Sessiz başlat, sonra unmute dene
  audio.muted = true;

  function updateBtn(){
    btn.textContent = (audio.paused || audio.muted) ? '🔇' : '🔊';
  }

  function tryUnmute(){
    audio.muted = false;
    audio.volume = 0.5;
    audio.play().catch(()=>{});
    updateBtn();
  }

  audio.play().then(()=>{
    setTimeout(tryUnmute, 800);
  }).catch(()=>{});

  // İlk etkileşimde sesi aç (iPhone/Safari için)
  const unlock = () => { tryUnmute(); cleanup(); };
  function cleanup(){
    window.removeEventListener('touchstart', unlock);
    window.removeEventListener('pointerdown', unlock);
    window.removeEventListener('keydown', unlock);
  }
  window.addEventListener('touchstart', unlock, {once:true});
  window.addEventListener('pointerdown', unlock, {once:true});
  window.addEventListener('keydown', unlock, {once:true});

  // Buton kontrolü
  btn.addEventListener('click', ()=>{
    if(audio.paused){
      audio.play().then(()=>{ audio.muted=false; audio.volume=0.5; updateBtn(); });
    } else {
      audio.pause();
      updateBtn();
    }
  });

  audio.addEventListener('play', updateBtn);
  audio.addEventListener('pause', updateBtn);
  updateBtn();
})();
</script>
